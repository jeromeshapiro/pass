cmake_minimum_required(VERSION 3.8) 
project(pass)

include_directories(include)

add_library(CLI src/cli.c)
target_include_directories(CLI
    PUBLIC 
        $<INSTALL_INTERFACE:include>    
        $<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/include>
    PRIVATE
        ${CMAKE_CURRENT_SOURCE_DIR}/src
)


add_library(CRYPTO src/crypto.c)
target_include_directories(CRYPTO
    PUBLIC 
        $<INSTALL_INTERFACE:include>    
        $<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/include>
    PRIVATE
        ${CMAKE_CURRENT_SOURCE_DIR}/src
)


add_library(STORAGE src/storage.c)
target_include_directories(STORAGE
    PUBLIC 
        $<INSTALL_INTERFACE:include>    
        $<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/include>
    PRIVATE
        ${CMAKE_CURRENT_SOURCE_DIR}/src
)


find_package(OpenSSL REQUIRED)
include_directories(${OPENSSL_INCLUDE_DIR})
if(OPENSSL_FOUND)
    set(OPENSSL_USE_STATIC_LIBS TRUE)
endif()


file(GLOB SOURCES "passphrase.c" "src/*.c")
add_executable(${PROJECT_NAME} ${SOURCES})

target_link_libraries(${PROJECT_NAME} OpenSSL::Crypto)

if(APPLE)
	install(TARGETS ${PROJECT_NAME} DESTINATION /usr/local/bin)
elseif(UNIX)
	install(TARGETS ${PROJECT_NAME} DESTINATION /usr/bin)
endif()

